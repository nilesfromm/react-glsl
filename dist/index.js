"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _react = require('react'); var _react2 = _interopRequireDefault(_react);var C={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},H= exports.ShaderCanvas =L=>{let{glsl:p,uniforms:_,style:E}=L,[a,b]=_react.useState.call(void 0, {x:0,y:0}),s=p,c=`#version 300 es
    in vec4 a_position;
    void main() {
      gl_Position = a_position;
    }
  `,[e,R]=_react.useState.call(void 0, ),t=_react.useRef.call(void 0, ),u=_react.useRef.call(void 0, null);_react.useEffect.call(void 0, ()=>{let r=u.current;if(r){R(_optionalChain([r, 'access', _2 => _2.getContext, 'optionalCall', _3 => _3("webgl2",{...C})]));let o=r.clientWidth|0,n=r.clientHeight|0;(r.width!==o||r.height!==n)&&(r.width=o,r.height=n)}},[u]);let f=_react.useCallback.call(void 0, (r,o)=>{if(!e)return;if(o!==e.VERTEX_SHADER&&o!==e.FRAGMENT_SHADER)throw new Error("Shader Type error");let n=e.createShader(o);if(!n)throw new Error("Shader Generation error");return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||console.error("Shader Compile error: "+e.getShaderInfoLog(n)),n},[e]),m=_react.useCallback.call(void 0, ({vertex:r,fragment:o})=>{if(!e)return;if(t.current=e.createProgram(),!t.current)throw new Error("Unable to create program.");let n=f(r,e.VERTEX_SHADER),d=f(o,e.FRAGMENT_SHADER);if(e.attachShader(t.current,n),e.attachShader(t.current,d),e.linkProgram(t.current),!e.getProgramParameter(t.current,e.LINK_STATUS))throw e.detachShader(t.current,n),e.detachShader(t.current,d),e.deleteShader(n),e.deleteShader(d),new Error(`Unable to initialize the shader program:
`+e.getProgramInfoLog(t.current));let x=e.createVertexArray();e.bindVertexArray(x);let y=e.getUniformLocation(t.current,"resolution"),P=e.getUniformLocation(t.current,"mouse"),h=e.getAttribLocation(t.current,"a_position");if(h>=0){var g=e.createVertexArray();e.bindVertexArray(g);let T=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,T),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(h),e.vertexAttribPointer(h,2,e.FLOAT,!1,0,0),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(t.current),e.uniform2f(y,e.canvas.width,e.canvas.height),e.uniform2f(P,a.x,a.y),e.bindVertexArray(g),e.drawArrays(e.TRIANGLES,0,6)}},[f,e,a]),l=r=>{if(!e||!t.current)return;r*=.001;let o=e.getUniformLocation(t.current,"mouse"),n=e.getUniformLocation(t.current,"time");e.uniform2f(o,a.x,a.y),e.uniform1f(n,r),e.drawArrays(e.TRIANGLES,0,6),requestAnimationFrame(l)};requestAnimationFrame(l);let M=_react.useCallback.call(void 0, r=>{if(e&&t.current)return _nullishCoalesce(e.getUniformLocation(t.current,r), () => (void 0))},[e,t]);_react.useEffect.call(void 0, ()=>{!e||!c||!s||m({vertex:c,fragment:s})},[e,c,s,m]);let w=_react.useCallback.call(void 0, r=>{let o=r.target;b({x:r.nativeEvent.offsetX/o.offsetWidth,y:1-r.nativeEvent.offsetY/o.offsetHeight})},[a]);return _react2.default.createElement("canvas",{ref:u,onMouseMove:r=>w(r),style:{width:"100%",height:"100%",...E}})};exports.ShaderCanvas = H;
//# sourceMappingURL=index.js.map