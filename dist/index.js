"use strict";function r(r,e){if(e==null||e>r.length)e=r.length;for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function e(r){if(Array.isArray(r))return r}function t(e){if(Array.isArray(e))return r(e)}function n(r,e,t){if(e in r){Object.defineProperty(r,e,{value:t,enumerable:true,configurable:true,writable:true})}else{r[e]=t}return r}function a(r){if(typeof Symbol!=="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function o(r,e){var t=r==null?null:typeof Symbol!=="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(t==null)return;var n=[];var a=true;var o=false;var i,u;try{for(t=t.call(r);!(a=(i=t.next()).done);a=true){n.push(i.value);if(e&&n.length===e)break}}catch(r){o=true;u=r}finally{try{if(!a&&t["return"]!=null)t["return"]()}finally{if(o)throw u}}return n}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};var a=Object.keys(t);if(typeof Object.getOwnPropertySymbols==="function"){a=a.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))}a.forEach(function(e){n(r,e,t[e])})}return r}function c(r,t){return e(r)||o(r,t)||s(r,t)||i()}function f(r){return t(r)||a(r)||s(r)||u()}function s(e,t){if(!e)return;if(typeof e==="string")return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}Object.defineProperty(exports,"__esModule",{value:true});function d(r,e){if(r!=null){return r}else{return e()}}function v(r){var e=undefined;var t=r[0];var n=1;while(n<r.length){var a=r[n];var o=r[n+1];n+=2;if((a==="optionalAccess"||a==="optionalCall")&&t==null){return undefined}if(a==="access"||a==="optionalAccess"){e=t;t=o(t)}else if(a==="call"||a==="optionalCall"){var i;t=o(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++){n[a]=arguments[a]}return(i=t).call.apply(i,[e].concat(f(n)))});e=undefined}}return t}var h=require("react");var m=require("react/jsx-runtime");var y={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1};function g(r){var e=r.glsl,t=r.uniforms,n=r.style,a=c(h.useState.call(void 0,{x:0,y:0}),2),o=a[0],i=a[1],u=e,f="#version 300 es\n    in vec4 a_position;\n    void main() {\n      gl_Position = a_position;\n    }\n  ",s=c(h.useState.call(void 0),2),g=s[0],b=s[1],p=h.useRef.call(void 0),A=h.useRef.call(void 0,null);h.useEffect.call(void 0,function(){var r=A.current;if(r){b(v([r,"access",function(r){return r.getContext},"optionalCall",function(r){return r("webgl2",l({},y))}]));var e=r.clientWidth|0,t=r.clientHeight|0;(r.width!==e||r.height!==t)&&(r.width=e,r.height=t)}},[A]);var S=h.useCallback.call(void 0,function(r,e){if(!g)return;if(e!==g.VERTEX_SHADER&&e!==g.FRAGMENT_SHADER)throw new Error("Shader Type error");var t=g.createShader(e);if(!t)throw new Error("Shader Generation error");return g.shaderSource(t,r),g.compileShader(t),g.getShaderParameter(t,g.COMPILE_STATUS)||console.error("Shader Compile error: "+g.getShaderInfoLog(t)),t},[g]),w=h.useCallback.call(void 0,function(r){var e=r.vertex,t=r.fragment;if(!g)return;if(p.current=g.createProgram(),!p.current)throw new Error("Unable to create program.");var n=S(e,g.VERTEX_SHADER),a=S(t,g.FRAGMENT_SHADER);if(g.attachShader(p.current,n),g.attachShader(p.current,a),g.linkProgram(p.current),!g.getProgramParameter(p.current,g.LINK_STATUS))throw g.detachShader(p.current,n),g.detachShader(p.current,a),g.deleteShader(n),g.deleteShader(a),new Error("Unable to initialize the shader program:\n"+g.getProgramInfoLog(p.current));var i=g.createVertexArray();g.bindVertexArray(i);var u=g.getUniformLocation(p.current,"resolution"),l=g.getUniformLocation(p.current,"mouse"),c=g.getAttribLocation(p.current,"a_position");if(c>=0){var f=g.createVertexArray();g.bindVertexArray(f);var s=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,s),g.bufferData(g.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),g.STATIC_DRAW),g.enableVertexAttribArray(c),g.vertexAttribPointer(c,2,g.FLOAT,!1,0,0),g.viewport(0,0,g.canvas.width,g.canvas.height),g.clearColor(0,0,0,1),g.clear(g.COLOR_BUFFER_BIT),g.useProgram(p.current),g.uniform2f(u,g.canvas.width,g.canvas.height),g.uniform2f(l,o.x,o.y),g.bindVertexArray(f),g.drawArrays(g.TRIANGLES,0,6)}},[S,g,o]),E=function(r){if(!g||!p.current)return;r*=.001;var e=g.getUniformLocation(p.current,"mouse"),t=g.getUniformLocation(p.current,"time");g.uniform2f(e,o.x,o.y),g.uniform1f(t,r),g.drawArrays(g.TRIANGLES,0,6),requestAnimationFrame(E)};requestAnimationFrame(E);var R=h.useCallback.call(void 0,function(r){if(g&&p.current)return d(g.getUniformLocation(p.current,r),function(){return void 0})},[g,p]);h.useEffect.call(void 0,function(){!g||!f||!u||w({vertex:f,fragment:u})},[g,f,u,w]);var x=h.useCallback.call(void 0,function(r){var e=r.target;i({x:r.nativeEvent.offsetX/e.offsetWidth,y:1-r.nativeEvent.offsetY/e.offsetHeight})},[o]);return m.jsx.call(void 0,"canvas",{ref:A,onMouseMove:function(r){return x(r)},style:l({width:"100%",height:"100%"},n)})}exports.ShaderCanvas=g;//# sourceMappingURL=index.js.map